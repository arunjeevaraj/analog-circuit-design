::: {.content-hidden}
Copyright (C) 2025 Harald Pretl and co-authors (harald.pretl@jku.at)

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
:::

# Differential OTAs {#sec-differential-ota}

So far, we have discussed the implementation of OTAs with a differential input and a single-ended output. Often, in integrated circuits, we want to implement fully differential signal chains, as this allows an almost-rail-to-rail swing around a common-mode voltage. Further, noise pickup due to limited power-supply rejection ratio (PSRR) or coupling into the differential signal routing can be suppressed by designing amplifiers with high common-mode rejection ratio (CMRR).

The OTA presented in @ec-ota-variants-single-ended can be readily adapted for differential output. Striving for maximum utility, we are discussing a popular two-stage differential-output OTA with a special kind of load, shown in @fig-diff-ota-resload.

{{< include ./figures/_fig_ota_diff_twostage.qmd >}}

This OTA shows a load on top of the differential pair that we have not yet studied. It is instructive to analyze this structure in terms of differential and common-mode operation.

For common-mode operation (i.e., injecting the same current into the drain of $M_3$ and $M_4$) we have the same voltage at the drains of $M_{3,5}$, thus $\VDS[3]=\VDS[5]$. We have thus no current flowing through $R_{1,2}$ and as a result $\VDS[3]=\VDS[5] = V_\mathrm{X} = \VGS[3] = \VGS[5] = \VGS[3,5]$. We realize that $M_3$ and $M_5$ are diode-connected for common-mode operation. We thus have well-defined dc operating points, and also low common-mode gain, since the common-mode load is $\gm[3]^{-1} \parallel \gm[5]^{-1}$.

For pure differential operation, the mid-point $X$ of $R_{1,2}$ acts as a virtual ground. The bias voltage $\VGS[3,5]$ is thus not changed (it is set only by the common-mode operation) and thus $M_3$ and $M_5$ operate as current sources. The differential load impedance is high and is given by $R_\mathrm{load} = (R_1 + R_2) \parallel (\gds[3]^{-1} + \gds[5]^{-1})$.

In addition, we realize that $\VGS[4] = \VGS[3] = \VGS[5] = \VGS[6]$ for common-mode operation, hence the quiescent current of $M_{4,6}$ is set in a current-mirror-like fashion by the diode-connected $M_{3,5}$.

For differential operation, the differential pair of $M_{1,2}$ is loaded by $R_\mathrm{load}$ and provides fairly high gain. The second gain stage is formed by current-source-loaded common-source stages $M_{4,6}$ and provides additional gain (of course, this is a function of the load impedance).

As soon as we implement a two-stage amplifier we need to look into stability. We likely have more than two poles, and in the case of the amplifier in @fig-ota-res-load we have a low-frequency pole at the drains of $M_{1,3}$ and $M_{2,5}$ and a furter low-frequency pole at the output. Any additional pole will add further phase shift making stability critical. We now need a method to stabilize this amplifier and thus we will look into *Miller compensation*.

## Miller Compensation

